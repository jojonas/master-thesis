% !TeX root = document.tex

% Latex-Style
% Jonas Lieb (jonas.lieb@rwth-aachen.de)
% Januar 2017

% =====================================
% pragmas for latex compiler

% pdf compression
\pdfminorversion=5 
\pdfcompresslevel=9 
\pdfobjcompresslevel=9

% =====================================
% packages

% encoding
\RequirePackage[T1]{fontenc}
\RequirePackage[utf8]{inputenc}

\RequirePackage[
	figuresep=colon,
	sansserif=false,
	hangfigurecaption=false,
	hangsection=true,
	hangsubsection=true,
	colorize=full,
	colortheme=matplotlib,
	bibsys=bibtex
]{cleanthesis}

% font for titles (from tex-gyre)
\RequirePackage{tgheros}

% font
%\RequirePackage{lmodern}

% language
\RequirePackage[english]{babel}

% enables graphics inclusion
\RequirePackage[final]{graphicx}
%\setkeys{Gin}{width=\linewidth}
\DeclareGraphicsRule{.1}{mps}{*}{}
\DeclareGraphicsRule{.2}{mps}{*}{}
\DeclareGraphicsRule{.3}{mps}{*}{}
\DeclareGraphicsRule{.4}{mps}{*}{}
\DeclareGraphicsRule{.5}{mps}{*}{}

% floating figures (with [h])
\RequirePackage{float}
\RequirePackage{placeins}
\floatplacement{table}{h}
\floatplacement{figure}{h}

% references (without being highlighted)
\RequirePackage[
	pdfborder={0 0 0},
	breaklinks=true,
	plainpages=false,
	colorlinks=false,
	bookmarksnumbered=true,
	bookmarksopen=true,
	draft=false
]{hyperref}

\RequirePackage[plain]{fancyref}
\newcommand*{\fancyrefapplabelprefix}{app}
\fancyrefaddcaptions{english}{%
  \providecommand*{\frefappname}{appendix}%
  \providecommand*{\Frefappname}{Appendix}%
}
\frefformat{plain}{\fancyrefapplabelprefix}{\frefappname\fancyrefdefaultspacing#1}
\Frefformat{plain}{\fancyrefapplabelprefix}{\Frefappname\fancyrefdefaultspacing#1}

\frefformat{vario}{\fancyrefapplabelprefix}{%
  \frefappname\fancyrefdefaultspacing#1#3%
}
\Frefformat{vario}{\fancyrefapplabelprefix}{%
  \Frefappname\fancyrefdefaultspacing#1#3%
}

% drawings
\RequirePackage{tikz}
\usepackage{tikz-qtree}
\usetikzlibrary{trees}

% Feynman diagrams
\RequirePackage[force]{feynmp-auto}
\setlength{\unitlength}{1cm}
      
% Pseudocode listings
\RequirePackage{algorithm}
\RequirePackage{algpseudocode}
      
% non-italic greek letters (for SI-prefixes)
\RequirePackage{upgreek}

% awesome units!
\RequirePackage[
	binary-units=true,
	range-phrase={ to },
	mode=text,
	separate-uncertainty=true,
	group-digits=integer,
	group-minimum-digits=4,
	table-number-alignment=right,
	table-text-alignment=center,
	table-unit-alignment=left,
	locale=US,
]{siunitx}
% declare upright micro symbol
\DeclareSIPrefix{\micro}{$\upmu$}{-6}

% nice fractions (for quark charges)
\RequirePackage{nicefrac}

% particle names
\RequirePackage{hepnames}

% particle physics units
%\RequirePackage{hepunits}

% Shortcuts often used in physics
\RequirePackage{physics}

% miscellaneous math enhancements from AMS-TeX
\RequirePackage{amsmath}

% slash notation (e.g. for MET)
\RequirePackage{slashed}

% xspace: conditional space
\RequirePackage{xspace}

% extended symbol collection from AMS-TeX
\RequirePackage{amssymb}

% additional multirow/multicolumn feature in tables
\RequirePackage{multirow}
\RequirePackage{bigdelim}
\RequirePackage{rotating}

% multiple text columns
\RequirePackage{multicol}

% pretty tables
\RequirePackage{booktabs}
\RequirePackage{longtable}

% footnotes
\RequirePackage{tablefootnote}

% pretty ToC
%\RequirePackage[titles]{tocloft}
\renewcommand\cftchapfont{\thesisparagraphfont}

% glossary entries
\RequirePackage{acronym}
% remove space in \acfi and \acfia
\renewcommand{\acfia}[1]{%
{\itshape \AC@acl{#1}\nolinebreak[3]} (\ifAC@starred\acs*{#1}\else\acs{#1}\fi)}

% nagging about obsolete commands
\RequirePackage[l2tabu, orthodox]{nag}

% for custom Math typesetting 
\RequirePackage{mathtools}

% ceil and floor macro
\DeclarePairedDelimiter\bceil{\lceil}{\rceil}
\newcommand{\ceil}{\bceil*}

\DeclarePairedDelimiter\bfloor{\lfloor}{\rfloor}
\newcommand{\floor}{\bfloor*}

% =====================================
% style

% citations
\RequirePackage{cite}

% typesetting improvements
% Todo: try kerning=true, tracking=true and see if it makes any difference
\RequirePackage{microtype}

% spacing between figures/tables and text
\setlength{\intextsep}{1\parskip+1\baselineskip}

% table padding
\def\arraystretch{1.3}

% numbers in math mode
%\makeatletter
%\DeclareSymbolFont{sfnumbers}{T1}{\biolinum@family}{m}{n}
%\SetSymbolFont{sfnumbers}{bold}{T1}{\biolinum@family}{b}{n}
%\makeatother
%\DeclareMathSymbol{0}\mathalpha{sfnumbers}{"30}
%\DeclareMathSymbol{1}\mathalpha{sfnumbers}{"31}
%\DeclareMathSymbol{2}\mathalpha{sfnumbers}{"32}
%\DeclareMathSymbol{3}\mathalpha{sfnumbers}{"33}
%\DeclareMathSymbol{4}\mathalpha{sfnumbers}{"34}
%\DeclareMathSymbol{5}\mathalpha{sfnumbers}{"35}
%\DeclareMathSymbol{6}\mathalpha{sfnumbers}{"36}
%\DeclareMathSymbol{7}\mathalpha{sfnumbers}{"37}
%\DeclareMathSymbol{8}\mathalpha{sfnumbers}{"38}
%\DeclareMathSymbol{9}\mathalpha{sfnumbers}{"39}

% =====================================
% draft settings

\newcommand{\todo}[1]{
	{\color{red}\textbf{[TODO: #1]}}
	\message{TODO: #1}
}

\RequirePackage{ifdraft}
\ifdraft{
	%\RequirePackage{draftwatermark}
	
	%\SetWatermarkText{DRAFT}
	%\SetWatermarkScale{1.5}
	%\SetWatermarkLightness{0.95}
	
	\RequirePackage[left]{lineno}
	\linenumbers
	
	\overfullrule=5pt
}{
	\renewcommand{\todo}[1]{\errmessage{TODO: #1}}
}

\let\TODO\undefined


% =====================================
% commands

\newcommand{\nomath}[1]{\ifmmode \text{#1} \else #1 \fi}

\newcommand{\defeq}{\vcentcolon=}
\newcommand{\eqdef}{=\vcentcolon}

\newcommand{\Minv}{\ensuremath{M_\mathrm{inv}}\xspace}
\newcommand{\MT}{\ensuremath{M_\mathrm{T}}\xspace}
\newcommand{\pT}{\ensuremath{\vec{p}_\mathrm{T}}\xspace}
\newcommand{\sumpT}{\ensuremath{\Sigma p_T}\xspace}
\newcommand{\ET}{\ensuremath{E_\mathrm{T}}\xspace}
\newcommand{\MET}{\ensuremath{\slashed{E}_\mathrm{T}}\xspace}

\newcommand{\ptilde}{\ensuremath{\tilde{p}}\xspace}
\newcommand{\phat}{\ensuremath{\hat{p}}\xspace}
\newcommand{\p}{\ensuremath{p}\xspace}
\newcommand{\pxlio}{\texttt{pxlio}\xspace}
\newcommand{\deltaptilde}{\ensuremath{\Delta \tilde{p}}\xspace}

\newcommand{\eventclass}[1]{\mbox{\textsf{#1}}}
\newcommand{\Ndata}{\ensuremath{{N_\mathrm{obs}}}\xspace}
\newcommand{\Nmc}{\ensuremath{{N_\mathrm{SM}}}\xspace}
\newcommand{\sigmamc}{\ensuremath{{\sigma_\mathrm{SM}}}\xspace}

\newcommand{\mychi}{\ensuremath{\chi}\xspace}
\newcommand{\paramregions}{\ensuremath{{n_\mathrm{regions}}}\xspace}
\newcommand{\parambinbase}{\ensuremath{{n_\mathrm{base}}}\xspace}
\newcommand{\sigmarel}{\ensuremath{\sigma_\mathrm{rel}}\xspace}

\newcommand*{\vcenteredhbox}[1]{\begingroup
\setbox0=\hbox{#1}\parbox{\wd0}{\box0}\endgroup}

% For some reason, the Sigma particles are broken in hepnames, so I redefine them here
\renewcommand{\PgS}{\ensuremath{\Sigma}\xspace}
\renewcommand{\PgSpm}{\ensuremath{\Sigma^{\pm}}\xspace}
\renewcommand{\PgSmp}{\ensuremath{\Sigma^{\mp}}\xspace}
\renewcommand{\PgSm}{\ensuremath{\Sigma^{-}}\xspace}
\renewcommand{\PgSp}{\ensuremath{\Sigma^{+}}\xspace}
\renewcommand{\PgSz}{\ensuremath{\Sigma^{0}}\xspace}